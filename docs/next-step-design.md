# 下一步设计草案：迁移 / 导出 / 标签体系

## 目标

- 提供独立的迁移与导出页面
- 支持从其他 2FA 软件迁移（先以 otpauth / JSON 为主）
- 支持条目级导出与整库导出
- 建立条目组织能力：`tags`、`deprecated(弃用)`、`pinned(置顶)`

## 非目标（本阶段）

- 云同步
- 跨设备冲突合并
- 加密存储方案重构

## 信息架构

新增 3 个一级页面：

1. `验证码`（现有）
2. `管理`（现有）
3. `迁移与导出`（新增）

迁移与导出页面分 2 个区块：

- `导入`：粘贴 otpauth、导入 JSON、扫描二维码（后续）
- `导出`：导出全部、导出筛选结果、导出选中条目

## 交互流程

### 导入流程

1. 选择导入来源（otpauth / JSON / 二维码）
2. 预解析并展示预览列表
3. 对冲突条目给出策略：
   - 跳过
   - 覆盖
   - 保留并重命名
4. 提交导入并展示结果统计

### 导出流程

1. 选择范围（全部 / 当前筛选 / 已选择）
2. 选择格式（先 JSON）
3. 确认导出并落盘

## 数据模型扩展

在单条 entry 上新增：

- `tags: string[]`
- `deprecated: boolean`
- `deprecatedAt?: number`
- `pinned: boolean`（已有，继续沿用）
- `updatedAt: number`

建议排序优先级：

1. `deprecated = false` 优先
2. `pinned = true` 优先
3. 自定义排序（名称 / 最近使用）

## UI 规则

- 弃用条目：降低对比度 + 明确 badge（`已弃用`）
- 置顶条目：显示 pin 图标，排序固定靠前
- tags：支持多标签 chips，管理页可筛选

## 待确认项

1. 迁移冲突默认策略选哪一个（建议：`跳过`）
2. 导出 JSON 是否包含弃用条目（建议：包含，并保留标记）
3. tags 上限（建议：每条最多 10 个）

## 实施顺序

1. 扩展 entry 数据结构 + 本地存储迁移
2. 管理页支持 tags / 弃用 / 置顶显示与筛选
3. 新增迁移与导出页面（先 JSON + otpauth）
4. 再补二维码导入与更细粒度导出
